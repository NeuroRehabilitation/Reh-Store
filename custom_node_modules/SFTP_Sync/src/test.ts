console.clear();

import sftpBackup from './main';
import path from 'path';
import fs from 'fs-extra';

console.log("SFTP Backup test");

interface SyncListItem {
    from: string;
    to: string;
}

(async () => {
    const username = "SampleUser";
    let syncList: SyncListItem[] = [];
    let fromSoftware = fs.readdirSync(`C:\\Users\\teixe\\Documents\\RehStore\\${username}`);

    for (let i = 0; i < fromSoftware.length; i++) {
        fs.readdirSync(`C:\\Users\\teixe\\Documents\\RehStore\\${username}\\${fromSoftware[i]}`).forEach(item => {
            syncList.push({
                from: path.join(
                    `C:\\Users\\teixe\\Documents\\RehStore\\${username}\\${fromSoftware[i]}`,
                    item,
                    "5cc4e26f6ba5d2d2ce2f818404cc71223063f08c5b66592f1ee9ddd0db053d89"
                ),
                to: path.join(
                    `/${username}`,
                    fromSoftware[i],
                    item,
                    "5cc4e26f6ba5d2d2ce2f818404cc71223063f08c5b66592f1ee9ddd0db053d89"
                )
            });
        })
    }
    await sftpBackup("rehstore.arditi.pt", 8444, username, "SamplePass", syncList);
})();